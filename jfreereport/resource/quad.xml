<?xml version="1.0"?>
<report:report xmlns="http://www.w3.org/1999/xhtml"
        xmlns:report="http://jfreereport.sourceforge.net/namespaces/reports/flow">
  <report:datasource href="sample.sqlds"/>

  <report:query>default</report:query>

  <report:stylesheet href="quad.css"/>

  <!--
  pageheaders are not yet accepted by the layouter (in their special
  role). The layouter treats them as ordinary bands instead.
  -->
  <!--
  <report:out-of-order-section role="page-header">
    <div class="page-header">
      <report:content>
        <report:attribute name="format">yyyy-MM-dd</report:attribute>
        <report:value-expression>
          <report:property name="field">report.date</report:property>
        </report:value-expression>
      </report:content>
    </div>

  </report:out-of-order-section>
  -->

  <!--
  page footers are not yet accepted by the layouter (in their special
  role). The layouter treats them as ordinary bands instead.

  Page-counters are maintained by the layouter itself. There is no
  sane way to receive page events from the layouter. (Sure, it can
  be hacked, but this will kill the performance.)
  -->
  <!--
  <report:out-of-order-section role="page-footer">
    <div class="page-footer"/>

  </report:out-of-order-section>
  -->

  <!--
  There is no special report header. Everything before an group
  declaration will behave like a report header.
  -->
  <h1 class="report-header">
    Exciting Quadrant Data
  </h1>

  <p>
    This report demonstrates the new SQL-capabilities. The default query for
    the report is set to <code>default</code>, as specified by the
    <code>report:query</code> element.
  </p>
  <p>
    The query itself along with the connection details is defined in the
    datasource document (sample.sqlds).
  </p>

  <!--
  Groups are nested.
  -->
  <report:group virtual="true">
    <report:grouping-expression>
      <report:property name="field[0]">REGION</report:property>
    </report:grouping-expression>

    <!--
    This will be a little bit easier as soon as we have Excel-Style functions.
    -->
    <report:expression
            class="org.jfree.report.function.numeric.ItemSumFunction">
      <report:name>ActualSum</report:name>
      <report:property name="field">ACTUAL</report:property>
    </report:expression>

    <report:expression
            class="org.jfree.report.function.numeric.ItemSumFunction">
      <report:name>BudgetSum</report:name>
      <report:property name="field">BUDGET</report:property>
    </report:expression>

    <table>
      <col style="width: 40%"/>
      <col style="width: 20%"/>
      <col style="width: 20%"/>
      <col style="width: 20%"/>

      <tbody>
        <tr class="region-header">
          <td colspan="4">
            <report:content>
              <report:value-expression>
                <report:property name="field">REGION</report:property>
              </report:value-expression>
            </report:content>
          </td>
        </tr>

        <report:group virtual="true">
          <report:grouping-expression>
            <report:property name="field[0]">DEPARTMENT</report:property>
          </report:grouping-expression>

          <report:expression
                  class="org.jfree.report.function.numeric.ItemSumFunction">
            <report:name>ActualSum</report:name>
            <report:property name="field">ACTUAL</report:property>
          </report:expression>

          <report:expression
                  class="org.jfree.report.function.numeric.ItemSumFunction">
            <report:name>BudgetSum</report:name>
            <report:property name="field">BUDGET</report:property>
          </report:expression>

          <tr class="department-header">
            <td colspan="4">Department:
              <report:content>
                <report:value-expression>
                  <report:property name="field">DEPARTMENT</report:property>
                </report:value-expression>
              </report:content>
            </td>
          </tr>

          <tr class="department-col-headings">
            <td class="firstcol">
              Position
            </td>
            <td class="othercol">
              Actual
            </td>
            <td class="othercol">
              Budget
            </td>
            <td class="othercol">
              Variance
            </td>
          </tr>

          <report:detail-section virtual="true">
            <tr>
              <td class="firstcol">
                <report:content>
                  <report:value-expression>
                    <report:property name="field">POSITIONTITLE</report:property>
                  </report:value-expression>
                </report:content>
              </td>
              <td class="othercol">
                <report:content>
                  <report:value-expression>
                    <report:property name="field">ACTUAL</report:property>
                  </report:value-expression>
                </report:content>
              </td>
              <td class="othercol">
                <report:content>
                  <report:value-expression>
                    <report:property name="field">BUDGET</report:property>
                  </report:value-expression>
                </report:content>
              </td>
              <td class="othercol">
                <report:content>
                  <report:value-expression class="org.jfree.report.function.numeric.ColumnDifferenceExpression">
                    <report:property name="field[0]">BUDGET</report:property>
                    <report:property name="field[1]">ACTUAL</report:property>
                  </report:value-expression>
                </report:content>
              </td>
            </tr>
          </report:detail-section>

          <tr class="department-footer">
            <td>Total</td>
            <td class="othercol">
              <report:content>
                <report:value-expression>
                  <report:property name="field">ActualSum</report:property>
                </report:value-expression>
              </report:content>
            </td>
            <td class="othercol">
              <report:content>
                <report:value-expression>
                  <report:property name="field">BudgetSum</report:property>
                </report:value-expression>
              </report:content>
            </td>
            <td class="othercol">
              <report:content>
                <report:value-expression class="org.jfree.report.function.numeric.ColumnDifferenceExpression">
                  <report:property name="field[0]">BudgetSum</report:property>
                  <report:property name="field[1]">ActualSum</report:property>
                </report:value-expression>
              </report:content>
            </td>
          </tr>
        </report:group>

        <tr>
          <td>Total</td>
          <td class="othercol">
            <report:content>
              <report:value-expression>
                <report:property name="field">ActualSum</report:property>
              </report:value-expression>
            </report:content>
          </td>
          <td class="othercol">
            <report:content>
              <report:value-expression>
                <report:property name="field">BudgetSum</report:property>
              </report:value-expression>
            </report:content>
          </td>
          <td class="othercol">
            <report:content>
              <report:value-expression class="org.jfree.report.function.numeric.ColumnDifferenceExpression">
                <report:property name="field[0]">ActualSum</report:property>
                <report:property name="field[1]">BudgetSum</report:property>
              </report:value-expression>
            </report:content>
          </td>
        </tr>

      </tbody>
    </table>


  </report:group>

  <h2>End of Report</h2>

</report:report>