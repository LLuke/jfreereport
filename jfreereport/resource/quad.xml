<?xml version="1.0"?>
<report:report xmlns="http://www.w3.org/1999/xhtml"
        xmlns:report="http://jfreereport.sourceforge.net/namespaces/reports/flow">
  <report:datasource href="sample.sqlds"/>

  <report:query>default</report:query>

  <report:stylesheet href="quad.css"/>

  <report:configuration>
    <report:property name="org.jfree.SomeConfigProperty">SomeConfigValue</report:property>
  </report:configuration>

  <!--
  pageheaders are not yet accepted by the layouter (in their special
  role). The layouter treats them as ordinary bands instead.
  -->
  <!--
  <report:out-of-order-section role="page-header">
    <div class="page-header">
      <report:content>
        <report:attribute name="format">yyyy-MM-dd</report:attribute>
        <report:value-expression>
          <report:property name="field">report.date</report:property>
        </report:value-expression>
      </report:content>
    </div>

  </report:out-of-order-section>
  -->

  <!--
  page footers are not yet accepted by the layouter (in their special
  role). The layouter treats them as ordinary bands instead.

  Page-counters are maintained by the layouter itself. There is no
  sane way to receive page events from the layouter. (Sure, it can
  be hacked, but this will kill the performance.)
  -->
  <!--
  <report:out-of-order-section role="page-footer">
    <div class="page-footer"/>

  </report:out-of-order-section>
  -->

  <!--
  There is no special report header. Everything before an group
  declaration will behave like a report header.
  -->
  <h1 class="report-header">
    Exciting Quadrant Data
  </h1>

  <p>
    This report demonstrates the new SQL-capabilities. The default query for
    the report is set to <code>default</code>, as specified by the
    <code>report:query</code> element.
  </p>
  <p>
    The query itself along with the connection details is defined in the
    datasource document (sample.sqlds).
  </p>

  <!--
  Groups are nested.
  -->
  <report:group virtual="true">
    <report:grouping-expression formula="jfreereport:GroupBy(&quot;REGION&quot;)"/>

    <!--
    This will be a little bit easier as soon as we have Excel-Style functions.
    This one uses the excel expression but not the itemsum expression
    -->
    <report:expression name="ActualSum" formula="jfreereport:[ActualSum] + [ACTUAL]"/>

    <!--
     And this one uses the ItemSum (excel style, of course)
     -->
    <report:expression name="BudgetSum" formula="jfreereport:SUM([BUDGET])"/>

    <table>
      <col style="width: 40%"/>
      <col style="width: 20%"/>
      <col style="width: 20%"/>
      <col style="width: 20%"/>

      <tbody>
        <tr class="region-header">
          <td colspan="4">
            <report:content>
              <report:value-expression formula="jfreereport:[REGION]"/>
            </report:content>
          </td>
        </tr>

        <report:group virtual="true">
          <report:grouping-expression formula="jfreereport:GroupBy(&quot;DEPARTMENT&quot;)"/>
          <report:expression name="ActualSum" formula="jfreereport:SUM([ACTUAL])"/>
          <report:expression name="BudgetSum" formula="jfreereport:SUM([BUDGET])"/>

          <tr class="department-header">
            <td colspan="4">Department:
              <report:content>
                <report:value-expression formula="jfreereport:[DEPARTMENT]"/>
              </report:content>
            </td>
          </tr>

          <tr class="department-col-headings">
            <td class="firstcol">
              Position
            </td>
            <td class="othercol">
              Actual
            </td>
            <td class="othercol">
              Budget
            </td>
            <td class="othercol">
              Variance
            </td>
          </tr>

          <report:detail-section virtual="true">
            <tr>
              <td class="firstcol">
                <report:content>
                  <report:value-expression formula="jfreereport:[POSITIONTITLE]"/>
                </report:content>
              </td>
              <td class="othercol">
                <report:content>
                  <report:value-expression formula="jfreereport:[ACTUAL]"/>
                </report:content>
              </td>
              <td class="othercol">
                <report:content>
                  <report:value-expression formula="jfreereport:[BUDGET]"/>
                </report:content>
              </td>
              <td class="othercol">
                <report:content>
                  <report:value-expression formula="jfreereport:[BUDGET] - [ACTUAL]"/>
                </report:content>
              </td>
            </tr>
          </report:detail-section>

          <tr class="department-footer">
            <td>Total</td>
            <td class="othercol">
              <report:content>
                <report:value-expression formula="jfreereport:[ActualSum]"/>
              </report:content>
            </td>
            <td class="othercol">
              <report:content>
                <report:value-expression formula="jfreereport:[BudgetSum]"/>
              </report:content>
            </td>
            <td class="othercol">
              <report:content>
                <report:value-expression formula="jfreereport:[BudgetSum] - [ActualSum]"/>
              </report:content>
            </td>
          </tr>
        </report:group>

        <tr>
          <td>Total</td>
          <td class="othercol">
            <report:content>
              <report:value-expression formula="jfreereport:[ActualSum]"/>
            </report:content>
          </td>
          <td class="othercol">
            <report:content>
              <report:value-expression formula="jfreereport:[BudgetSum]"/>
            </report:content>
          </td>
          <td class="othercol">
            <report:content>
              <report:value-expression formula="jfreereport:[BudgetSum] - [ActualSum]"/>
            </report:content>
          </td>
        </tr>

      </tbody>
    </table>


  </report:group>

  <h2>End of Report</h2>

</report:report>