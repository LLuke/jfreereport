<!-- An ANT build file for JFreeReport -->

<!-- This is the master control file for all ant builds. -->

<project name="jfreereport" default="all" basedir="..">


  <target name="init">
    <description>
      Initializes all common properties.
    </description>
    <dirname property="antfile.dir" file="${ant.file}"/>
    <property file="${antfile.dir}/build.properties"/>

    <available file="${libdir}/${jcommon-jar-file}" type="file" property="jcommon-jar-file-present"/>
    <fail unless="jcommon-jar-file-present">
      The file ${libdir}/${jcommon-jar-file} was not found in the lib directory.
      This file is required for all builds.
    </fail>

    <available file="${libdir}/${pixie-jar-file}" property="pixie-jar-file-present"/>
    <fail unless="pixie-jar-file-present">
      The file ${pixie-jar-file} was not found in the lib directory.
      This file is required for all builds.
    </fail>

  </target>

  <target name="copy-resources">
    <copy file="source/org/jfree/report/jfreereport.properties"
      tofile="build/org/jfree/report/jfreereport.properties"/>
  </target>

  <target name="compile" depends="init">
    <description>
      Compiles the core classes of JFreeReport. This will be the base for
      all modules.
    </description>

    <!-- create a temp build directory -->
    <mkdir dir="build"/>

    <!-- compile the source -->
    <!-- We exclude all module implementations and the demos by default -->
    <javac srcdir="source"
      destdir="build"
      deprecation="${build.deprecation}" debug="${build.debug}" optimize="${build.optimize}" target="${build.target}">
      <include name="**/*.java"/>
      <exclude name="org/jfree/report/demo/**"/>
      <exclude name="org/jfree/report/modules/gui/**"/>
      <exclude name="org/jfree/report/modules/misc/**"/>
      <exclude name="org/jfree/report/modules/output/**"/>
      <exclude name="org/jfree/report/modules/parser/**"/>
      <classpath>
        <pathelement location="${libdir}/${jcommon-jar-file}" />
        <pathelement location="${libdir}/${pixie-jar-file}" />
      </classpath>
    </javac>

    <antcall target="copy-resources" inheritAll="true"/>

    <!-- make the jar -->
    <jar jarfile="${core-jar-file}"
         basedir="build">
      <manifest>
          <attribute name="Class-Path"
            value="${manifest-lib-prefix}${jcommon-jar-file} ${manifest-lib-prefix}${pixie-jar-file}"/>
      </manifest>
    </jar>

    <!-- delete the temp directory -->
    <delete dir="build" />
  </target>

  <target name="all" depends="init, compile">
  </target>

</project>
